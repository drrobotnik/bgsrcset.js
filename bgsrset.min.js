function dynamicSort(e){var t=1;if(e[0]==="-"){t=-1;e=e.substr(1)}return function(n,r){var i=n[e]<r[e]?-1:n[e]>r[e]?1:0;return i*t}}var bgsrcset=function(){this.called=false;this.callonce=true;this.compat()};bgsrcset.prototype.init=function(e,t){this.target=e;this.retina=window.devicePixelRatio>1;this.elements=[];this.callback=typeof t!=="undefined"?t:function(){};this.curwidth=this.getWidth();var n=this.gather();for(var r=0,i=n.length;r<i;r++){this.parse(n[r])}this.set();this.resize()};bgsrcset.prototype.compat=function(){var e=document;if(typeof e.getElementsByClassName!="function"){e.getElementsByClassName=function(t){return e.querySelectorAll("."+t)}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!e.addEventListener){this.addEvent=function(e,t,n){e.attachEvent("on"+t,function(e){n(e||window.event)})}}};bgsrcset.prototype.gather=function(){var e=document,t=this.target.trim(),n=t[0],r=[];switch(true){case n===".":r=e.getElementsByClassName(t.substring(1));break;case n==="#":r.push(e.getElementById(t.substring(1)));break;case/^[a-zA-Z]+$/.test(t):r=e.getElementsByTagName(t);break;default:r=e.querySelectorAll(t)}return r};bgsrcset.prototype.parse=function(e){if(e.getAttribute("bg-srcset")===null){return false}this.elements.push({});var t=e.getAttribute("bg-srcset").split(","),n="",r=this.elements[this.elements.length-1];r.node=e;r.srcset=[];for(var i=0,s=t.length;i<s;i++){r.srcset.push({});n=t[i].trim();var o=n.split(" ");for(var u=0,a=o.length;u<a;u++){var f=o[u],l=r.srcset[i];switch(true){case f.trim()=="":continue;break;case f[f.length-1]!="w"&&f[f.length-1]!="x":l.src=f;break;case f[f.length-1]==="w":l.width=parseInt(f.slice(0,-1));break;case f[f.length-1]==="x":l.retina=parseInt(f.slice(0,-1))>1;break}if(!l.width){l.width=Number.POSITIVE_INFINITY}if(!l.retina){l.retina=false}}}};bgsrcset.prototype.set=function(){for(var e=0,t=this.elements.length;e<t;e++){this.setSingle(e)}};bgsrcset.prototype.setSingle=function(e){var t=0,n=this.elements[e],r=[],i=0,s=this;t=this.getWidth();n.srcset=n.srcset.sort(dynamicSort("width"));for(var o=0,u=n.srcset.length;o<u;o++){if(n.srcset[o].width<t){continue}r.push(n.srcset[o])}if(r.length===0){r.push(n.srcset[n.srcset.length-1])}i=r[0];if(r.length>1&&r[0].width===r[1].width){i=r[0].retina!=this.retina?r[1]:r[0]}if(i.src!=undefined&&i.src!="null"){var a=new Image;a.onload=function(){n.node.style.backgroundImage="url('"+i.src+"')";if(!s.called){s.callback(n);s.called=s.callonce}};a.src=i.src}else{n.node.style.backgroundImage=""}};bgsrcset.prototype.resize=function(){var e=this,t=setTimeout(function(){},0);this.addEvent(window,"resize",function(){clearTimeout(t);t=setTimeout(function(){var t=e.getWidth();if(t!=e.curwidth){e.curwidth=t;e.set()}},250)})};bgsrcset.prototype.addEvent=function(e,t,n){e.addEventListener(t,n,false)};bgsrcset.prototype.getWidth=function(){var e=window,t=document,n=t.documentElement,r=t.getElementsByTagName("body")[0],i=e.innerWidth||n.clientWidth||r.clientWidth;return i}